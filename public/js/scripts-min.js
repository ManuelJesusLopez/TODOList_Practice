"use strict";var form=document.getElementById("form"),info=document.getElementById("info"),tasks=document.getElementById("tasks"),taskList=[],currentDate=new Date,taskIsValid={task:!1,priority:!1,date:!1},taskInfo=document.createElement("P"),getRemainTime=function(t){var a=new Date,e=(new Date(t)-a+1e3)/1e3;return{remainTime:e,remainSeconds:("0"+Math.floor(e%60)).slice(-2),remainMinutes:("0"+Math.floor(e/60%60)).slice(-2),remainHours:("0"+Math.floor(e/3600%24)).slice(-2),remainDays:Math.floor(e/86400)}},countdown=function(t,a,e){var s=document.getElementById(a),n=setInterval((function(){var a=getRemainTime(t);s.textContent="".concat(a.remainDays,"d:").concat(a.remainHours,"h:").concat(a.remainMinutes,"m:").concat(a.remainSeconds,"s"),a.remainTime<=1&&(clearInterval(n),s.textContent=e)}),1e3)},createTask=function(t,a,e){var s={name:t,priority:a,date:e,idCount:Math.round(100*Math.random())};return taskList.unshift(s),s},addTask=function(){localStorage.setItem("task",JSON.stringify(taskList)),printTask()},printTask=function(){tasks.innerHTML="",null===(taskList=JSON.parse(localStorage.getItem("task")))?taskList=[]:taskList.forEach((function(t){var a=t.priority,e=t.name,s=t.date,n=t.idCount;tasks.innerHTML+='\n      <div class="task priority__'.concat(a,'">\n        <p class="task__name">').concat(e,'</p>\n          <div class="date-view">\n            <div class="date-view__top">\n              <p class="date-view__item">La fecha de finalización es:</p>\n            </div>\n            <div class="date-view__bottom">\n              <p class="date-view__item" id="').concat(n,'"></p>\n            </div>\n          </div>\n        <button class="delete-task">\n          <span class="material-icons">\n            delete\n          </span>\n        </button>\n      </div>\n      '),countdown(s,n,"La tarea esta fuera de tiempo"),console.log(n)}))},deleteTask=function(t){var a=taskList.findIndex((function(a){return a.name===t}));taskList.splice(a,1),addTask()},validateTask=function(){var t=Object.values(taskIsValid).findIndex((function(t){return!1===t})),a=document.createDocumentFragment();switch(t){case-1:taskInfo.classList.remove("incorrect-task"),taskInfo.classList.add("correct-task"),taskInfo.textContent="Tarea Creada correctamente. Click encima de la tarea para completarla.",a.append(taskInfo),setTimeout((function(){taskInfo.classList.remove("correct-task"),taskInfo.classList.add("hidden")}),3e3),form.reset();break;case 0:taskInfo.classList.remove("hidden"),taskInfo.classList.add("incorrect-task"),taskInfo.textContent="Necesita escribir un nombre a la tarea",a.append(taskInfo);break;case 1:taskInfo.classList.remove("hidden"),taskInfo.classList.add("incorrect-task"),taskInfo.textContent="Seleccione prioridad",a.append(taskInfo);break;case 2:taskInfo.classList.remove("hidden"),taskInfo.classList.add("incorrect-task"),taskInfo.textContent="Seleccione una fecha válida",a.append(taskInfo)}info.append(a)};form.addEventListener("change",(function(t){(t.preventDefault(),"text"===t.target.type&&(t.target.value.trim().length>0?taskIsValid.task=!0:taskIsValid.task=!1),"radio"===t.target.type&&(!0===t.target.checked?taskIsValid.priority=!0:taskIsValid.priority=!1),"datetime-local"===t.target.type)&&(new Date(t.target.value).getTime()>currentDate.getTime()?taskIsValid.date=!0:taskIsValid.date=!1)})),form.addEventListener("submit",(function(t){t.preventDefault();var a=t.target.taskName.value,e=t.target.taskPriority.value,s=t.target.taskDate.value;validateTask(),!0===taskIsValid.task&&!0===taskIsValid.priority&&!0===taskIsValid.date&&(createTask(a,e,s),taskIsValid.task=!1,taskIsValid.priority=!1,taskIsValid.date=!1),addTask()})),document.addEventListener("DOMCOntentLoaded",printTask()),tasks.addEventListener("click",(function(t){t.preventDefault();var a=t.path[2].childNodes[1].innerText;"delete"===t.target.innerText.trim()&&deleteTask(a)})),tasks.addEventListener("click",(function(t){var a=t.target,e=t.target.parentElement;a.classList.contains("task__name")&&(a.classList.contains("task__done")?(a.classList.remove("task__done"),e.classList.remove("task__done-parent")):(a.classList.add("task__done"),e.classList.add("task__done-parent")))}));