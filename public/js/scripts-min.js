"use strict";var form=document.getElementById("form"),taskName=document.getElementById("taskName"),taskPriority=document.getElementById("taskPriority"),taskDate=document.getElementById("date"),info=document.getElementById("info"),tasks=document.getElementById("tasks"),taskList=[],currentDate=new Date,taskIsValid={task:!1,priority:!1,date:!1},taskInfo=document.createElement("P"),createTask=function(t,e,a){var n={name:t,priority:e,date:a};return taskList.push(n),n},addTask=function(){localStorage.setItem("task",JSON.stringify(taskList)),printTask()},printTask=function(){tasks.innerHTML="",null===(taskList=JSON.parse(localStorage.getItem("task")))?taskList=[]:taskList.forEach((function(t){tasks.innerHTML+='\n      <div class="task priority__'.concat(t.priority,'">\n        <p class="task__name">').concat(t.name,'</p>\n          <div class="date-view">\n            <div class="date-view__top">\n              <p class="date-view__item">La fecha de finalización es:</p>\n            </div>\n            <div class="date-view__bottom">\n              <p class="date-view__item" id="count"></p>\n            </div>\n          </div>\n        <button class="delete-task" id="delete-task">\n          <span class="material-icons">\n            delete\n          </span>\n        </button>\n      </div>\n      '),countdown(t.date,"count","La tarea esta fuera de tiempo")}))},getRemainTime=function(t){var e=new Date,a=(new Date(t)-e+1e3)/1e3;return{remainTime:a,remainSeconds:("0"+Math.floor(a%60)).slice(-2),remainMinutes:("0"+Math.floor(a/60%60)).slice(-2),remainHours:("0"+Math.floor(a/3600%24)).slice(-2),remainDays:Math.floor(a/86400)}},countdown=function(t,e,a){var n=document.getElementById(e),s=setInterval((function(){var e=getRemainTime(t);n.innerHTML="".concat(e.remainDays,":").concat(e.remainHours,":").concat(e.remainMinutes,":").concat(e.remainSeconds),e.remainTime<=1&&(clearInterval(s),n.innerHTML=a)}),1e3)},deleteTask=function(t){var e;taskList.forEach((function(a,n){a.name===t&&(e=n)})),taskList.splice(e,1),addTask()},validateTask=function(){var t=Object.values(taskIsValid).findIndex((function(t){return!1===t})),e=document.createDocumentFragment();switch(t){case-1:taskInfo.classList.remove("incorrect-task"),taskInfo.classList.add("correct-task"),taskInfo.textContent="Tarea Creada correctamente",e.append(taskInfo),setTimeout((function(){taskInfo.classList.remove("correct-task"),taskInfo.classList.add("hidden")}),3e3),form.reset();break;case 0:taskInfo.classList.remove("hidden"),taskInfo.classList.add("incorrect-task"),taskInfo.textContent="Necesita escribir un nombre a la tarea",e.append(taskInfo);break;case 1:taskInfo.classList.remove("hidden"),taskInfo.classList.add("incorrect-task"),taskInfo.textContent="Seleccione prioridad",e.append(taskInfo);break;case 2:taskInfo.classList.remove("hidden"),taskInfo.classList.add("incorrect-task"),taskInfo.textContent="Seleccione una fecha válida",e.append(taskInfo)}info.append(e)};taskName.addEventListener("change",(function(t){t.preventDefault(),t.target.value.trim().length>0?taskIsValid.task=!0:taskIsValid.task=!1})),taskPriority.addEventListener("change",(function(t){t.preventDefault(),!0===t.target.checked?taskIsValid.priority=!0:taskIsValid.priority=!1})),taskDate.addEventListener("change",(function(t){t.preventDefault(),new Date(t.target.value).getTime()>currentDate.getTime()?taskIsValid.date=!0:taskIsValid.date=!1})),form.addEventListener("submit",(function(t){t.preventDefault();var e=t.target.taskName.value,a=t.target.taskPriority.value,n=t.target.taskDate.value;validateTask(),!0===taskIsValid.task&&!0===taskIsValid.priority&&!0===taskIsValid.date&&(createTask(e,a,n),taskIsValid.task=!1,taskIsValid.priority=!1,taskIsValid.date=!1),addTask()})),document.addEventListener("DOMCOntentLoaded",printTask()),tasks.addEventListener("click",(function(t){t.preventDefault();var e=t.path[2].childNodes[1].innerText;"delete"===t.target.innerText.trim()&&deleteTask(e)}));