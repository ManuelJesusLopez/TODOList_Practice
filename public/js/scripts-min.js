"use strict";var form=document.getElementById("form"),info=document.getElementById("info"),tasks=document.getElementById("tasks"),taskList=[],currentDate=new Date,taskIsValid={task:!1,priority:!1,date:!1},taskInfo=document.createElement("P"),getRemainTime=function(t){var e=new Date,a=(new Date(t)-e+1e3)/1e3;return{remainTime:a,remainSeconds:("0"+Math.floor(a%60)).slice(-2),remainMinutes:("0"+Math.floor(a/60%60)).slice(-2),remainHours:("0"+Math.floor(a/3600%24)).slice(-2),remainDays:Math.floor(a/86400)}},countdown=function(t,e,a){var s=document.getElementById(e),n=setInterval((function(){var e=getRemainTime(t);s.innerHTML="".concat(e.remainDays,"d:").concat(e.remainHours,"h:").concat(e.remainMinutes,"m:").concat(e.remainSeconds,"s"),e.remainTime<=1&&(clearInterval(n),s.innerHTML=a)}),1e3)},createTask=function(t,e,a){var s={name:t,priority:e,date:a};return taskList.unshift(s),s},addTask=function(){localStorage.setItem("task",JSON.stringify(taskList)),printTask()},printTask=function(){tasks.innerHTML="",null===(taskList=JSON.parse(localStorage.getItem("task")))?taskList=[]:taskList.forEach((function(t){tasks.innerHTML+='\n      <div class="task priority__'.concat(t.priority,'">\n        <p class="task__name">').concat(t.name,'</p>\n          <div class="date-view">\n            <div class="date-view__top">\n              <p class="date-view__item">La fecha de finalización es:</p>\n            </div>\n            <div class="date-view__bottom">\n              <p class="date-view__item" id="count"></p>\n            </div>\n          </div>\n        <button class="delete-task" id="delete-task">\n          <span class="material-icons">\n            delete\n          </span>\n        </button>\n      </div>\n      '),countdown(t.date,"count","La tarea esta fuera de tiempo")}))},deleteTask=function(t){var e=taskList.findIndex((function(e){return e.name===t}));taskList.splice(e,1),addTask()},validateTask=function(){var t=Object.values(taskIsValid).findIndex((function(t){return!1===t})),e=document.createDocumentFragment();switch(t){case-1:taskInfo.classList.remove("incorrect-task"),taskInfo.classList.add("correct-task"),taskInfo.textContent="Tarea Creada correctamente",e.append(taskInfo),setTimeout((function(){taskInfo.classList.remove("correct-task"),taskInfo.classList.add("hidden")}),3e3),form.reset();break;case 0:taskInfo.classList.remove("hidden"),taskInfo.classList.add("incorrect-task"),taskInfo.textContent="Necesita escribir un nombre a la tarea",e.append(taskInfo);break;case 1:taskInfo.classList.remove("hidden"),taskInfo.classList.add("incorrect-task"),taskInfo.textContent="Seleccione prioridad",e.append(taskInfo);break;case 2:taskInfo.classList.remove("hidden"),taskInfo.classList.add("incorrect-task"),taskInfo.textContent="Seleccione una fecha válida",e.append(taskInfo)}info.append(e)};form.addEventListener("change",(function(t){(t.preventDefault(),"text"===t.target.type&&(t.target.value.trim().length>0?taskIsValid.task=!0:taskIsValid.task=!1),"radio"===t.target.type&&(!0===t.target.checked?taskIsValid.priority=!0:taskIsValid.priority=!1),"datetime-local"===t.target.type)&&(new Date(t.target.value).getTime()>currentDate.getTime()?taskIsValid.date=!0:taskIsValid.date=!1)})),form.addEventListener("submit",(function(t){t.preventDefault();var e=t.target.taskName.value,a=t.target.taskPriority.value,s=t.target.taskDate.value;validateTask(),!0===taskIsValid.task&&!0===taskIsValid.priority&&!0===taskIsValid.date&&(createTask(e,a,s),taskIsValid.task=!1,taskIsValid.priority=!1,taskIsValid.date=!1),addTask()})),document.addEventListener("DOMCOntentLoaded",printTask()),tasks.addEventListener("click",(function(t){t.preventDefault();var e=t.path[2].childNodes[1].innerText;"delete"===t.target.innerText.trim()&&deleteTask(e)})),tasks.addEventListener("click",(function(t){var e=t.target;e.classList.contains("task__name")&&(e.classList.contains("task__done")?e.classList.remove("task__done"):e.classList.add("task__done"))}));